<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Send Name to Telegram Bot</title>
  <style>
    body { font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; display:flex; align-items:center; justify-content:center; height:100vh; margin:0; background:#f6f8fa }
    .card { background:white; padding:24px; border-radius:12px; box-shadow:0 6px 20px rgba(0,0,0,0.08); width:360px }
    h1 { font-size:18px; margin:0 0 12px }
    label { display:block; margin-bottom:6px; font-size:14px }
    input[type=text] { width:100%; padding:10px 12px; border-radius:8px; border:1px solid #ddd; box-sizing:border-box }
    .row { display:flex; gap:8px; margin-top:12px }
    button { flex:1; padding:10px 12px; border-radius:8px; border:0; cursor:pointer }
    button#sendBtn { background:#2d8cff; color:white }
    .status { margin-top:10px; font-size:13px }
  </style>
</head>
<body>
  <div class="card">
    <h1>Enter your name</h1>
    <form id="nameForm">
      <label for="nameInput">Name</label>
      <input id="nameInput" type="text" placeholder="Enter your name" required />

      <div class="row">
        <button id="sendBtn" type="submit">Done</button>
      </div>

      <div class="status" id="status"></div>
    </form>
  </div>

  <script>
    const statusEl = document.getElementById('status');
    const form = document.getElementById('nameForm');
    const nameInput = document.getElementById('nameInput');

    function setStatus(msg, isError=false) {
      statusEl.textContent = msg;
      statusEl.style.color = isError ? 'crimson' : 'green';
    }

    async function sendViaServer(name) {
      try {
        setStatus('Sending...');
        const res = await fetch('/send-name', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ name })
        });
        if (!res.ok) {
          const text = await res.text();
          setStatus('Server error: ' + text, true);
          return;
        }
        const json = await res.json();
        if (json && json.ok) setStatus('Sent âœ…');
        else setStatus('Server replied with error: ' + JSON.stringify(json), true);
      } catch (err) {
        setStatus('Network error: ' + err.message, true);
      }
    }

    form.addEventListener('submit', (e) => {
      e.preventDefault();
      const name = nameInput.value.trim();
      if (!name) { setStatus('Please enter a name', true); return; }
      sendViaServer(name);
    });
  </script>
</body>
</html>